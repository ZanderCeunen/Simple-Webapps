<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generate Documents</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        textarea {
            width: 100%;
            height: 100px;
            margin-bottom: 10px;
        }
        input, button {
            display: block;
            margin-bottom: 10px;
            padding: 10px;
            font-size: 16px;
        }
        button {
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>Enter Group Names</h1>
    <form id="groupForm">
        <textarea id="groupnames" placeholder="Enter group names, one per line"></textarea>
        <label for="margins">Margins (inches):</label>
        <input type="number" id="margins" value="1" min="0" step="0.1">
        <button type="button" onclick="generateDocs()">Generate Documents</button>
    </form>

    <!-- JS Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docxtemplater/3.21.1/docxtemplater.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/file-saver/2.0.5/FileSaver.min.js"></script>
    
    <script>
        async function generateDocs() {
            const { jsPDF } = window.jspdf;
            const groupNames = document.getElementById("groupnames").value.split('\\n').map(name => name.trim()).filter(name => name);
            const margins = parseFloat(document.getElementById("margins").value) || 1;
            
            // PDF Generation
            const pdf = new jsPDF('landscape', 'in', 'letter');
            pdf.setMargins(margins, margins, margins, margins);
            
            groupNames.forEach((name, idx) => {
                if (idx > 0) pdf.addPage();
                let fontSize = 48;
                pdf.setFontSize(fontSize);
                let splitText = pdf.splitTextToSize(name, pdf.internal.pageSize.width - 2 * margins);
                while (splitText.length > 1) {
                    fontSize -= 2;
                    pdf.setFontSize(fontSize);
                    splitText = pdf.splitTextToSize(name, pdf.internal.pageSize.width - 2 * margins);
                }
                pdf.text(name, pdf.internal.pageSize.width / 2, pdf.internal.pageSize.height / 2, { align: 'center' });
            });
            
            pdf.save('output.pdf');
            
            // DOCX Generation
            const doc = new docx.Document();
            
            groupNames.forEach(name => {
                const paragraph = new docx.Paragraph({
                    children: [new docx.TextRun({
                        text: name,
                        size: 48 * 2,
                        break: 1
                    })],
                    alignment: docx.AlignmentType.CENTER,
                });
                
                doc.addSection({
                    properties: {
                        page: {
                            size: {
                                orientation: docx.PageOrientation.LANDSCAPE,
                            },
                            margin: {
                                top: docx.convertInchesToTwip(margins),
                                bottom: docx.convertInchesToTwip(margins),
                                left: docx.convertInchesToTwip(margins),
                                right: docx.convertInchesToTwip(margins),
                            },
                        },
                    },
                    children: [paragraph],
                });
            });
            
            const blob = await docx.Packer.toBlob(doc);
            saveAs(blob, "output.docx");
        }
    </script>
</body>
</html>
